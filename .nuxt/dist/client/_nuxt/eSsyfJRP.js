import{C as O,D as Q,r as g,g as G,l as H,c as o,a as e,z as m,t as d,F as v,n as f,m as J,x as W,A as X,E as Y,o as a,p as l,s as $,q as A}from"./AkD5g4Ve.js";import{u as Z}from"./6njsMXsu.js";const I={class:"container mx-auto px-4 py-8"},ee={class:"flex flex-col md:flex-row gap-8"},te={class:"w-full md:w-1/3 space-y-6"},se={class:"bg-glass-light dark:bg-glass-dark backdrop-blur-md rounded-xl p-6 shadow-glass"},re={class:"text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center"},oe={key:0,class:"ml-2 bg-primary-600 text-white text-xs font-medium px-2.5 py-0.5 rounded-full"},ae={key:0,class:"text-gray-500 dark:text-gray-400 text-center py-4"},ne={key:1,class:"mb-4"},ie={class:"space-y-3"},le={class:"flex items-center"},de=["src"],ce={class:"font-medium"},ue={class:"flex space-x-2 mt-2 sm:mt-0 ml-auto"},ge=["onClick"],me=["onClick"],ye={key:2},he={class:"space-y-3"},_e={class:"flex items-center"},pe=["src"],xe={class:"font-medium"},ve={class:"bg-glass-light dark:bg-glass-dark backdrop-blur-md rounded-xl p-6 shadow-glass"},fe={class:"text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center"},be={key:0,class:"ml-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white text-xs font-medium px-2.5 py-0.5 rounded-full"},ke={key:0,class:"flex justify-center py-4"},we={key:1,class:"text-gray-500 dark:text-gray-400 text-center py-4"},Fe={key:2,class:"space-y-3"},Re=["onClick"],Ce={class:"flex items-center"},qe={class:"relative"},je=["src"],Pe={class:"font-medium"},Se={class:"text-xs text-gray-500 dark:text-gray-400"},$e={class:"flex space-x-2 mt-2 sm:mt-0 ml-auto"},Ae=["onClick"],Te=["onClick"],Ne={class:"w-full md:w-2/3"},Ue={class:"bg-glass-light dark:bg-glass-dark backdrop-blur-md rounded-xl p-6 shadow-glass"},Le={class:"mb-6"},Be={class:"relative"},De={key:0,class:"flex justify-center py-4"},Me={key:1,class:"text-gray-500 dark:text-gray-400 text-center py-4"},Ve={key:2,class:"space-y-3"},ze={class:"flex items-center"},Ee=["src"],Ke={class:"font-medium"},Oe=["onClick","disabled"],Je={__name:"friends",setup(Qe){const T=Y(),n=O(),{loading:N,getFriendsList:U,getFriendRequests:L,searchUsers:R,respondToFriendRequest:C,removeFriend:B,getProfilePictureUrl:h}=Z(),{onlineFriends:c,sendFriendRequest:D,respondToFriendRequest:q}=Q(),u=g([]),i=g({received:[],sent:[]}),_=g(""),p=g([]),b=g(!1),j=g(!1),M=G(()=>N.value);H(async()=>{await k(),await x()});async function k(){try{u.value=await U()}catch(r){n.error("Failed to load friends"),console.error(r)}}async function x(){try{i.value=await L()}catch(r){n.error("Failed to load friend requests"),console.error(r)}}async function P(){if(_.value.trim()){b.value=!0,j.value=!0;try{p.value=await R(_.value)}catch(r){n.error("Failed to search users"),console.error(r)}finally{b.value=!1}}}async function V(r){try{D(r),await R(r),n.success("Friend request sent"),await x()}catch(s){n.error("Failed to send friend request"),console.error(s)}}async function z(r){try{q(r,!0),await C(r,!0),n.success("Friend request accepted"),await k(),await x()}catch(s){n.error("Failed to accept friend request"),console.error(s)}}async function E(r){try{q(r,!1),await C(r,!1),n.success("Friend request rejected"),await x()}catch(s){n.error("Failed to reject friend request"),console.error(s)}}async function K(r){try{await B(r),n.success("Friend removed"),await k()}catch(s){n.error("Failed to remove friend"),console.error(s)}}function S(r){T.push(`/chat/${r}`)}function w(r){return u.value.some(s=>s._id===r)}function F(r){return i.value.sent.some(s=>s.receiver._id===r)||i.value.received.some(s=>s.sender._id===r)}return(r,s)=>(a(),o("div",I,[e("div",ee,[e("div",te,[e("div",se,[e("h2",re,[s[1]||(s[1]=e("span",null,"Friend Requests",-1)),i.value.received.length>0?(a(),o("span",oe,d(i.value.received.length),1)):m("",!0)]),i.value.received.length===0&&i.value.sent.length===0?(a(),o("div",ae," No pending friend requests ")):m("",!0),i.value.received.length>0?(a(),o("div",ne,[s[2]||(s[2]=e("h3",{class:"text-sm font-medium text-gray-600 dark:text-gray-300 mb-2"},"Received",-1)),e("ul",ie,[(a(!0),o(v,null,f(i.value.received,t=>(a(),o("li",{key:t._id,class:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg"},[e("div",le,[e("img",{src:l(h)(t.sender),alt:"Profile",class:"w-10 h-10 rounded-full object-cover mr-3"},null,8,de),e("span",ce,d(t.sender.username),1)]),e("div",ue,[e("button",{onClick:y=>z(t._id),class:"px-3 py-1 bg-primary-600 hover:bg-primary-700 text-white rounded-md text-sm transition-colors"}," Accept ",8,ge),e("button",{onClick:y=>E(t._id),class:"px-3 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-md text-sm transition-colors"}," Reject ",8,me)])]))),128))])])):m("",!0),i.value.sent.length>0?(a(),o("div",ye,[s[4]||(s[4]=e("h3",{class:"text-sm font-medium text-gray-600 dark:text-gray-300 mb-2"},"Sent",-1)),e("ul",he,[(a(!0),o(v,null,f(i.value.sent,t=>(a(),o("li",{key:t._id,class:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg"},[e("div",_e,[e("img",{src:l(h)(t.receiver),alt:"Profile",class:"w-10 h-10 rounded-full object-cover mr-3"},null,8,pe),e("span",xe,d(t.receiver.username),1)]),s[3]||(s[3]=e("span",{class:"text-xs text-gray-500 dark:text-gray-400 mt-2 sm:mt-0"},"Pending",-1))]))),128))])])):m("",!0)]),e("div",ve,[e("h2",fe,[s[5]||(s[5]=e("span",null,"Friends",-1)),u.value.length>0?(a(),o("span",be,d(u.value.length),1)):m("",!0)]),M.value?(a(),o("div",ke,s[6]||(s[6]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)]))):u.value.length===0?(a(),o("div",we," No friends yet. Start by adding some! ")):(a(),o("ul",Fe,[(a(!0),o(v,null,f(u.value,t=>(a(),o("li",{key:t._id,class:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg hover:bg-white/80 dark:hover:bg-gray-700/80 transition-colors cursor-pointer",onClick:y=>S(t._id)},[e("div",Ce,[e("div",qe,[e("img",{src:l(h)(t),alt:"Profile",class:"w-10 h-10 rounded-full object-cover mr-3"},null,8,je),e("span",{class:$(["absolute bottom-0 right-2 w-3 h-3 rounded-full",{"bg-green-500":l(c).get(t._id)==="online","bg-yellow-500":l(c).get(t._id)==="away","bg-gray-500":!l(c).get(t._id)||l(c).get(t._id)==="offline"}])},null,2)]),e("div",null,[e("div",Pe,d(t.username),1),e("div",Se,d(l(c).get(t._id)==="online"?"Online":l(c).get(t._id)==="away"?"Away":"Offline"),1)])]),e("div",$e,[e("button",{onClick:A(y=>S(t._id),["stop"]),class:"px-3 py-1 bg-primary-600 hover:bg-primary-700 text-white rounded-md text-sm transition-colors"}," Chat ",8,Ae),e("button",{onClick:A(y=>K(t._id),["stop"]),class:"px-3 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-white rounded-md text-sm transition-colors"}," Remove ",8,Te)])],8,Re))),128))]))])]),e("div",Ne,[e("div",Ue,[s[8]||(s[8]=e("h2",{class:"text-xl font-bold text-gray-800 dark:text-white mb-4"},"Find Friends",-1)),e("div",Le,[e("div",Be,[J(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>_.value=t),type:"text",placeholder:"Search by username or email",class:"w-full px-4 py-2 bg-white/70 dark:bg-gray-800/70 border border-gray-300 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-600 dark:focus:ring-primary-500",onKeyup:X(P,["enter"])},null,544),[[W,_.value]]),e("button",{onClick:P,class:"absolute right-2 top-1/2 transform -translate-y-1/2 px-3 py-1 bg-primary-600 hover:bg-primary-700 text-white rounded-md text-sm transition-colors"}," Search ")])]),b.value?(a(),o("div",De,s[7]||(s[7]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)]))):p.value.length===0&&j.value?(a(),o("div",Me," No users found matching your search ")):p.value.length>0?(a(),o("ul",Ve,[(a(!0),o(v,null,f(p.value,t=>(a(),o("li",{key:t._id,class:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 bg-white/50 dark:bg-gray-800/50 rounded-lg"},[e("div",ze,[e("img",{src:l(h)(t),alt:"Profile",class:"w-10 h-10 rounded-full object-cover mr-3"},null,8,Ee),e("span",Ke,d(t.username),1)]),e("button",{onClick:y=>V(t._id),class:$(["px-3 py-1 bg-primary-600 hover:bg-primary-700 text-white rounded-md text-sm transition-colors mt-2 sm:mt-0",{"opacity-50 cursor-not-allowed":w(t._id)||F(t._id)}]),disabled:w(t._id)||F(t._id)},d(w(t._id)?"Already Friends":F(t._id)?"Request Pending":"Add Friend"),11,Oe)]))),128))])):m("",!0)])])])]))}};export{Je as default};
